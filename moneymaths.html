<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Money Maths Game</title>
<link rel="icon" href="data:," />
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#000;
  --card:#111;
  --muted:#aaa;
  --accent:#FF1493;
  --glass: rgba(255,255,255,0.03);
}

body, html {margin:0; padding:0; height:100%; font-family: 'Inter', sans-serif; background: var(--bg); color:#fff; display:flex; justify-content:center;}
#appWrapper{width:100%; max-width:480px; display:flex; flex-direction:column; height:100%; position:relative;}

/* ---------- Header ---------- */
#gameHeader {text-align:center; margin-top:10px;}
#welcomeText{font-family:'Press Start 2P', cursive; font-size:12px; color:var(--accent);}
#scrambleText{font-family:'Press Start 2P', cursive; font-size:22px; color:var(--accent); margin-top:2px;}

/* ---------- Rules ---------- */
#rulesBtn {display:block; margin:6px auto; padding:6px 12px; border-radius:12px; background:var(--card); border:1px solid rgba(255,20,147,0.2); color:var(--accent); font-weight:700; cursor:pointer;}

/* ---------- Marquee ---------- */
#wordMarquee {width:100%; overflow:hidden; white-space:nowrap; display:block; border-top:1px solid rgba(255,255,255,0.1); border-bottom:1px solid rgba(255,255,255,0.1); padding:4px 0; margin-bottom:6px; color:var(--accent); font-size:12px;}
#wordMarquee span {margin-right:12px; display:inline-block;}

/* ---------- Scramble Board / Challenge ---------- */
.scramble-board {text-align:center; margin:8px 0;}
#expressions {font-family:'Press Start 2P', cursive; font-size:18px; letter-spacing:3px; color:#fff;}

/* ---------- Messages ---------- */
#messages {flex:1; overflow-y:auto; padding:8px; display:flex; flex-direction:column; gap:6px;}

/* ---------- Bottom Input ---------- */
.send-area {position:fixed; bottom:0; left:0; width:100%; max-width:480px; display:flex; align-items:center; gap:8px; background:var(--card); padding:10px; border-radius:999px; box-sizing:border-box; z-index:100;}
.send-area input {flex:1; padding:12px 16px; border-radius:999px; border:1px solid rgba(255,255,255,0.08); background-color:#0e0e0e; color:#fff; font-size:16px; outline:none;}

/* Buzz Button */
.buzz-btn {padding:10px; border-radius:999px; background:#000; border:1px solid var(--accent); color:var(--accent); font-weight:700; font-size:16px; cursor:pointer; animation: flicker 2s infinite alternate;}
@keyframes flicker {0%{opacity:1;}50%{opacity:0.6;}100%{opacity:1;}}

/* ---------- Profile Panel ---------- */
.profile {position:fixed; bottom:60px; width:100%; max-width:480px; left:0; display:flex; justify-content:center; z-index:99;}
.profile-card {background:var(--glass); padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); display:flex; flex-direction:column; gap:6px; text-align:center;}
.profile-name {font-weight:800; font-size:14px; color:var(--accent);}
.profile-info {font-size:12px; color:#fff;}

/* Star popup */
.star-popup{position:fixed;left:50%;top:20%;transform:translateX(-50%);background:var(--card);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.05);display:none;z-index:1000;color:var(--accent);font-size:13px;text-align:center;}

/* Countdown */
#countdown {text-align:center; font-size:14px; color:var(--accent); margin-top:6px; display:none;}
</style>
</head>
<body>
<div id="appWrapper">
  <!-- Header -->
  <div id="gameHeader">
    <div id="welcomeText">WELCOME TO</div>
    <div id="scrambleText">MONEY MATHS üí∞</div>
  </div>

  <!-- Rules -->
  <button id="rulesBtn">Rules</button>

  <!-- Marquee for solved challenges -->
  <div id="wordMarquee"></div>

  <!-- Challenge display -->
  <div class="scramble-board">
    <div id="expressions">0 + 0 = ?</div>
  </div>

  <!-- Messages -->
  <div id="messages"></div>

  <!-- Countdown -->
  <div id="countdown"></div>

  <!-- Bottom input -->
  <div class="send-area">
    <input type="text" id="buzzInput" placeholder="Buzz your answer...">
    <button id="buzzBtn" class="buzz-btn">üö®</button>
  </div>

  <!-- Profile panel -->
  <div class="profile" id="profilePanel">
    <div class="profile-card">
      <div class="profile-name" id="profileName">GUEST 0000</div>
      <div class="profile-info">STARS COLLECTED: <span id="starCount">0</span>‚≠êÔ∏è</div>
      <div class="profile-info">CASH EARNED: ‚Ç¶<span id="cashCount">0</span></div>
    </div>
  </div>
</div>

<!-- Star popup -->
<div class="star-popup" id="starPopup">+1 ‚≠ê</div>

<script>
/* ---------------- Sample User Data ---------------- */
let currentUser = {
  uid: 'guest001',
  name: 'GUEST 0000',
  stars: 100,
  cash: 0
};
document.getElementById('profileName').textContent = currentUser.name;
document.getElementById('starCount').textContent = currentUser.stars;
document.getElementById('cashCount').textContent = currentUser.cash;

/* ---------------- Game Logic ---------------- */
let currentChallenge = null;
let entriesCount = 0;
const MAX_ENTRIES = 53;
const BUZZ_COST = 5; // stars per buzz
const REWARD_STARS = 20;
const REWARD_CASH = 50;
const CHALLENGE_INTERVAL_MS = 5000;
let cooldownTimer = null;
const submittedAnswers = new Set();
const wordMarquee = document.getElementById("wordMarquee");
const expressionsEl = document.getElementById("expressions");
const buzzInput = document.getElementById("buzzInput");
const messagesEl = document.getElementById("messages");
const starPopup = document.getElementById("starPopup");
const countdownEl = document.getElementById("countdown");

/* ---------- Utils ---------- */
function getRandomInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

/* ---------- Generate Challenge ---------- */
function generateChallenge(){
  const ops = ["+","-","*"];
  let a = getRandomInt(1,10);
  let b = getRandomInt(1,10);
  let op = ops[getRandomInt(0,ops.length-1)];
  let answer = eval(`${a}${op}${b}`);
  currentChallenge = { expr: `${a} ${op} ${b} = ?`, answer: answer.toString() };
  expressionsEl.textContent = currentChallenge.expr;
}

/* ---------- Show Star Popup ---------- */
function showStarPopup(text){
  starPopup.textContent = text;
  starPopup.style.display = "block";
  setTimeout(()=>starPopup.style.display="none",1500);
}

/* ---------- Buzz Handler ---------- */
function handleBuzz(){
  if(entriesCount >= MAX_ENTRIES){
    showStarPopup("This money has been solved! Wait for next session.");
    return;
  }
  if(currentUser.stars < BUZZ_COST){
    showStarPopup("Not enough stars to buzz!");
    return;
  }
  const input = buzzInput.value.trim();
  if(!input){
    showStarPopup("Type your answer!");
    return;
  }

  entriesCount++;
  currentUser.stars -= BUZZ_COST;

  // Check answer
  let correct = input === currentChallenge.answer;

  if(correct){
    currentUser.stars += REWARD_STARS;
    currentUser.cash += REWARD_CASH;
    showStarPopup(`üéâ Correct! +${REWARD_STARS}‚≠ê & ‚Ç¶${REWARD_CASH}`);
    // Add solved challenge to marquee
    const span = document.createElement("span");
    span.textContent = currentChallenge.expr + " = " + currentChallenge.answer;
    wordMarquee.appendChild(span);
  } else {
    showStarPopup("‚ùå Wrong answer!");
  }

  // Update profile display
  document.getElementById('starCount').textContent = currentUser.stars;
  document.getElementById('cashCount').textContent = currentUser.cash;

  // Add to messages
  const msg = document.createElement('div');
  msg.textContent = currentUser.name + ": " + input + (correct?" ‚úÖ":" ‚ùå");
  messagesEl.appendChild(msg);
  messagesEl.scrollTop = messagesEl.scrollHeight;

  buzzInput.value = "";

  if(entriesCount >= MAX_ENTRIES) startCooldown();
}

/* ---------- Cooldown ---------- */
function startCooldown(minutes=10){
  let timer = minutes * 60;
  countdownEl.style.display = "block";

  cooldownTimer = setInterval(()=>{
    if(timer <=0){
      clearInterval(cooldownTimer);
      entriesCount = 0;
      countdownEl.style.display = "none";
      generateChallenge();
      return;
    }
    const min = Math.floor(timer/60);
    const sec = timer%60;
    countdownEl.textContent = `Next session in ${min}:${sec <10?'0'+sec:sec}`;
    timer--;
  },1000);
}

/* ---------- Start Game ---------- */
generateChallenge();
setInterval(generateChallenge, CHALLENGE_INTERVAL_MS);
document.getElementById('buzzBtn').addEventListener('click', handleBuzz);

/* ---------- Rules ---------- */
document.getElementById('rulesBtn').addEventListener('click',()=>{
  alert(`üéÆ Money Maths Rules:
- Buzz answers using the input above.
- Each buzz costs ${BUZZ_COST}‚≠ê.
- Correct answer gives +${REWARD_STARS}‚≠ê and +‚Ç¶${REWARD_CASH}.
- Max ${MAX_ENTRIES} buzzes per session.
- New math challenge every ${CHALLENGE_INTERVAL_MS/1000} seconds.
- Wait for next session after ${MAX_ENTRIES} entries.`);
});
</script>
</body>
</html>