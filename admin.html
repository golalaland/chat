<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
      display: flex;
      height: 100vh;
    }
    /* Sidebar */
    .sidebar {
      width: 220px;
      background: #222;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    .sidebar h2 { margin-bottom: 20px; }
    .sidebar button {
      margin: 5px 0;
      padding: 10px;
      width: 100%;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background: #333;
      color: #fff;
      transition: background .2s;
    }
    .sidebar button:hover { background: #444; }

    /* Content */
    .content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    .section { display: none; }
    .section.active { display: block; }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #333;
      padding: 8px;
      text-align: left;
    }
    th { background: #222; }

    /* Modal */
    .modal {
      position: fixed;
      top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.7);
      display:none;
      align-items:center; justify-content:center;
      z-index:1000;
    }
    .modal-content {
      background:#111;
      padding:20px;
      border-radius:8px;
      width:350px;
      max-width:90%;
      text-align:center;
      color:#fff;
    }
    .modal-actions { margin-top:20px; display:flex; justify-content:space-between; }
    .btn-secondary { background:#444; padding:8px 14px; border:none; border-radius:4px; color:#fff; cursor:pointer; }
    .btn-danger { background:#d33; padding:8px 14px; border:none; border-radius:4px; color:#fff; cursor:pointer; }
    .btn { padding:6px 10px; margin:2px; border:none; border-radius:4px; cursor:pointer; }
    .btn-action { background:#333; color:#fff; }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>Admin</h2>
    <button onclick="showSection('users')">Users</button>
    <button onclick="showSection('rooms')">Rooms</button>
    <button onclick="showSection('shop')">Shop</button>
    <button onclick="showSection('purchases')">Purchases</button>
    <button onclick="showSection('claims')">Claims</button>
  </div>

  <!-- Main Content -->
  <div class="content">

    <!-- USERS -->
    <section id="users" class="section active">
      <h2>Users</h2>
      <label><input type="checkbox" id="vipFilter"> Show only VIPs</label>
      <table id="usersTable">
        <thead>
          <tr>
            <th>Email</th>
            <th>Username</th>
            <th>Phone</th>
            <th>Invited By</th>
            <th>Stars</th>
            <th>Cash</th>
            <th>VIP</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- ROOMS -->
    <section id="rooms" class="section">
      <h2>Rooms</h2>
      <p>Here we’ll show active chatrooms, timeout users, and number of online users.</p>
    </section>

    <!-- SHOP -->
    <section id="shop" class="section">
      <h2>Shop</h2>
      <p>Manage shop items here.</p>
    </section>

    <!-- PURCHASES -->
    <section id="purchases" class="section">
      <h2>Purchases</h2>
      <p>Comprehensive spreadsheet-style purchases log.</p>
    </section>

    <!-- CLAIMS -->
    <section id="claims" class="section">
      <h2>Claims</h2>
      <p>Manage and refund claims here.</p>
    </section>

  </div>

  <!-- Modal -->
  <div id="adminModal" class="modal">
    <div class="modal-content">
      <h3 id="modalTitle"></h3>
      <p id="modalMessage"></p>
      <div class="modal-actions">
        <button id="modalCancel" class="btn-secondary">Cancel</button>
        <button id="modalConfirm" class="btn-danger">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js"></script>
  <script>
    // TODO: replace with your Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDbKz4ef_eUDlCukjmnK38sOwueYuzqoao",
  authDomain: "metaverse-1010.firebaseapp.com",
  projectId: "metaverse-1010",
  storageBucket: "metaverse-1010.firebasestorage.app",
  messagingSenderId: "1044064238233",
  appId: "1:1044064238233:web:2fbdfb811cb0a3ba349608",
  measurementId: "G-S77BMC266C"
};
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Section navigation
    function showSection(id) {
      document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    // Modal handler
    function showModal(title, message, onConfirm) {
      const modal = document.getElementById("adminModal");
      document.getElementById("modalTitle").innerText = title;
      document.getElementById("modalMessage").innerText = message;
      modal.style.display = "flex";

      document.getElementById("modalConfirm").onclick = () => {
        modal.style.display = "none";
        onConfirm();
      };
      document.getElementById("modalCancel").onclick = () => {
        modal.style.display = "none";
      };
    }

    // Load users
    const usersTableBody = document.querySelector("#usersTable tbody");
    const vipFilter = document.getElementById("vipFilter");

    async function loadUsers() {
      usersTableBody.innerHTML = "";
      const snapshot = await db.collection("users").get();
      snapshot.forEach(doc => {
        const u = doc.data();
        if (vipFilter.checked && !u.isVIP) return;

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${u.email || "-"}</td>
          <td>${u.username || "-"}</td>
          <td>${u.phone || "-"}</td>
          <td>${u.invitedBy || "-"}</td>
          <td>${u.stars || 0}</td>
          <td>${u.cash || 0}</td>
          <td>${u.isVIP ? "✅" : "❌"}</td>
          <td>
            <button class="btn btn-action" onclick="confirmAction('Kick ${u.username}', 'Kick ${u.username}?', () => kickUser('${doc.id}'))">Kick</button>
            <button class="btn btn-action" onclick="confirmAction('Ban ${u.username}', 'Ban ${u.username}?', () => banUser('${doc.id}'))">Ban</button>
            <button class="btn btn-action" onclick="confirmAction('Demote ${u.username}', 'Demote ${u.username}?', () => demoteUser('${doc.id}'))">Demote</button>
            <button class="btn btn-action" onclick="confirmAction('Timeout ${u.username}', 'Timeout ${u.username}?', () => timeoutUser('${doc.id}'))">Timeout</button>
            <button class="btn btn-action" onclick="confirmAction('Gift Stars', 'Gift 100 stars?', () => giftStars('${doc.id}', 100))">+⭐</button>
            <button class="btn btn-action" onclick="confirmAction('Gift Cash', 'Gift $10?', () => giftCash('${doc.id}', 10))">+$</button>
          </td>
        `;
        usersTableBody.appendChild(row);
      });
    }

    function confirmAction(title, msg, action) {
      showModal(title, msg, action);
    }

    // Placeholder functions (replace with Firestore logic)
    function kickUser(uid) { console.log("Kick", uid); }
    function banUser(uid) { console.log("Ban", uid); }
    function demoteUser(uid) { console.log("Demote", uid); }
    function timeoutUser(uid) { console.log("Timeout", uid); }
    function giftStars(uid, amt) { console.log("Gift", amt, "stars to", uid); }
    function giftCash(uid, amt) { console.log("Gift", amt, "cash to", uid); }

    vipFilter.addEventListener("change", loadUsers);
    loadUsers();
  </script>
</body>
</html>