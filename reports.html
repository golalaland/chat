<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shop Purchases Report</title>
<style>
  body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 20px; }
  h1 { text-align: center; }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background: #fff;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  th, td {
    padding: 12px;
    border: 1px solid #ddd;
    text-align: left;
  }
  th {
    background: #333;
    color: #fff;
  }
  tr:nth-child(even) { background: #f9f9f9; }
</style>
</head>
<body>

<h1>Shop Purchases Report</h1>

<table id="purchasesTable">
  <thead>
    <tr>
      <th>Purchase ID</th>
      <th>User ID</th>
      <th>Item Name</th>
      <th>Stars Spent</th>
      <th>Timestamp</th>
    </tr>
  </thead>
  <tbody>
    <!-- Data will be populated here -->
  </tbody>
</table>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
  // 1️⃣ Initialize Firebase
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // 2️⃣ Reference the Purchases collection
  const purchasesRef = db.collection("Purchases"); // Replace with your collection name

  // 3️⃣ Fetch purchases and populate table
  const tableBody = document.querySelector("#purchasesTable tbody");

  purchasesRef.orderBy("timestamp", "desc").onSnapshot((snapshot) => {
    tableBody.innerHTML = ""; // Clear table before rendering

    snapshot.forEach(doc => {
      const data = doc.data();
      const row = document.createElement("tr");

      row.innerHTML = `
        <td>${doc.id}</td>
        <td>${data.userId || '-'}</td>
        <td>${data.itemName || '-'}</td>
        <td>${data.starsSpent || 0}</td>
        <td>${data.timestamp ? new Date(data.timestamp.seconds * 1000).toLocaleString() : '-'}</td>
      `;
      tableBody.appendChild(row);
    });
  });
</script>

</body>
</html>
